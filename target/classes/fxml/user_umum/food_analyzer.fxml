<?xml version="1.0" encoding="UTF-8"?>
<?import javafx.geometry.Insets?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.control.*?>
<?import javafx.scene.chart.PieChart?>

<ScrollPane xmlns="http://javafx.com/javafx/8"
            xmlns:fx="http://javafx.com/fxml/1"
            fx:controller="com.nutrisense.controllers.user_umum.FoodAnalyzerController"
            fitToWidth="true" hbarPolicy="NEVER" vbarPolicy="AS_NEEDED"
            style="-fx-background: transparent;" stylesheets="@/css/home.css">

    <VBox spacing="40" style="-fx-padding: 50 80 100 80;" alignment="TOP_CENTER">

        <!-- HEADER -->
        <VBox spacing="10" alignment="CENTER_LEFT">
            <Label text="Food Analyzer" 
                   style="-fx-font-size: 38px; -fx-font-weight: 900; -fx-text-fill: white;"/>
            <Label text="Analisis kandungan gizi dari kombinasi makanan pilihanmu"
                   style="-fx-font-size: 18px; -fx-text-fill: #b0e0e0;"/>
        </VBox>

        <!-- INPUT CARD -->
        <VBox spacing="18" styleClass="glass-card">
            <Label text="Tambahkan Makanan" styleClass="section-title" style="-fx-font-size: 22px;"/>
            <HBox spacing="16" alignment="CENTER_LEFT">
                <ComboBox fx:id="foodComboBox" prefWidth="400" promptText="Ketik atau pilih makanan..." styleClass="combo-premium"/>
                <TextField fx:id="gramsField" text="100" prefWidth="120" promptText="gram" styleClass="text-field-premium"/>
                <Button text="Tambah" onAction="#onAddFood" styleClass="btn-primary"/>
            </HBox>
            <Label text="Tips: Ketik nama makanan lalu tekan Enter" styleClass="hint-text"/>
        </VBox>

        <!-- TABEL -->
        <VBox spacing="14">
            <HBox spacing="12" alignment="CENTER_LEFT">
                <Label text="Makanan Terpilih:" styleClass="section-title" style="-fx-font-size: 20px;"/>
                <Label fx:id="selectedCountLabel" text="0 makanan" styleClass="accent-count"/>
            </HBox>
            <TableView fx:id="foodsTableView" prefHeight="240" styleClass="table-premium"/>
            <HBox spacing="16">
                <Button text="Hapus Semua" onAction="#onClearAll" styleClass="btn-danger"/>
                <Button text="Reset" onAction="#onReset" styleClass="btn-warning"/>
            </HBox>
        </VBox>

        <!-- TOMBOL UTAMA -->
        <HBox spacing="30" alignment="CENTER">
            <Button text="Analisis Gizi" onAction="#onAnalyze" fx:id="analyzeButton" 
                    styleClass="btn-analyze-big" disable="true"/>
            <Button text="Kembali" onAction="#onBack" styleClass="btn-back"/>
        </HBox>

        <!-- HASIL ANALISIS -->
        <VBox fx:id="resultsSection" visible="false" spacing="50" alignment="CENTER">
            <Label text="Hasil Analisis Gizi" styleClass="result-title"/>

            <HBox spacing="40" alignment="TOP_CENTER">
                <!-- PIE CHART -->
                <VBox spacing="12" alignment="CENTER">
                    <Label text="Distribusi Makronutrien" styleClass="section-title" style="-fx-font-size: 35px;"/>
                    <PieChart fx:id="pieChart" prefWidth="980" prefHeight="600" styleClass="pie-glowing"/>
                </VBox>

                <!-- DETAIL NUTRISI -->
                <VBox spacing="20" prefWidth="500">
                    <Label text="Detail Nutrisi" styleClass="section-title" style="-fx-font-size: 30px;"/>
                    <VBox spacing="16" styleClass="nutrisi-big-card">

                            <Label text="Kalori Total" styleClass="nut-label"/>
                            <Label fx:id="kaloriLabel" text="0 kkal" styleClass="nut-big-value" style="-fx-text-fill: #ff6b6b;"/>
                            <Label text="Protein" styleClass="nut-label"/>
                            <Label fx:id="proteinLabel" text="0 g" styleClass="nut-big-value" style="-fx-text-fill: #9b59b6;"/>

                            <Label text="Karbohidrat" styleClass="nut-label"/>
                            <Label fx:id="karbohidratLabel" text="0 g" styleClass="nut-big-value" style="-fx-text-fill: #3498db;"/>

                            <Label text="Lemak" styleClass="nut-label"/>
                            <Label fx:id="lemakLabel" text="0 g" styleClass="nut-big-value" style="-fx-text-fill: #f39c12;"/>

                            <Label text="Serat" styleClass="nut-label"/>
                            <Label fx:id="seratLabel" text="0 g" styleClass="nut-big-value" style="-fx-text-fill: #00d4aa;"/>

                    </VBox>
                </VBox>
            </HBox>

            <!-- PERINGATAN -->
            <VBox fx:id="safetyAlertsSection" visible="false" styleClass="alert-box">
                <Label text="Peringatan Keamanan Makanan" styleClass="alert-title"/>
                <VBox fx:id="alertsContainer" spacing="10" style="-fx-padding: 10 20;"/>
            </VBox>
        </VBox>
    </VBox>
</ScrollPane>